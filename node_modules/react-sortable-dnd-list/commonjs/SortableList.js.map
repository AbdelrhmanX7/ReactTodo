{"version":3,"sources":["../source/SortableList.js"],"names":["SortableList","items","value","onChange","Component","component","ItemComponent","itemComponent","itemComponentProps","dragHandleDataAttribute","animationDuration","animationEasing","rest","list","dragging","setDragging","willEndDragging","setWillEndDragging","touchId","dragMoveHandler","draggedItemPosition","itemShiftsY","itemsOrder","prevItems","current","map","item","i","onTouchMove","window","addEventListener","removeEventListener","onDragStart","node","y","touch","length","getItem","itemNode","position","initialPosition","itemHeights","Array","prototype","call","childNodes","getBoundingClientRect","height","itemSpacing","top","bottom","itemTopOffset","dragStartY","previous","shiftY","_","onMouseDown","event","button","target","pageY","onTouchStart","touches","changedTouches","identifier","onDragMove","undefined","preventDefault","movedY","draggedItemOffsetTop","getDraggedItemPosition","draggedItemHeight","j","style","transform","getDraggedItemPositionY","onDragEnd","newItemsOrder","getNewItemsOrder","setTimeout","onMouseUp","which","onTouchEnd","passive","getItemStyle","TRANSFORM_NONE","propTypes","PropTypes","arrayOf","any","isRequired","func","elementType","object","number","string","isDragged","transition","zIndex","ListComponent","React","forwardRef","ref","children","defaultProps","IGNORE_CLICKS_INSIDE_TAGS","handle","childNode","indexOf","tagName","toLowerCase","dataset","parentElement","scanLineY","subtractOwnPosition","fromPosition","toPosition","slice","concat"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\n/**\r\n * Demo:\r\n * https://codepen.io/catamphetamine/pen/qBWxEQX\r\n *\r\n * `itemComponent` receives properties:\r\n * `dragging: boolean` — Is `true` when some item is being dragged.\r\n * `dragged: boolean` — Is `true` when this item is being dragged.\r\n * `style: object` — The `style` that must be set on the item root element.\r\n */\r\nexport default function SortableList({\r\n\tvalue: items,\r\n\tonChange,\r\n\tcomponent: Component,\r\n\titemComponent: ItemComponent,\r\n\titemComponentProps,\r\n\tdragHandleDataAttribute,\r\n\tanimationDuration,\r\n\tanimationEasing,\r\n\t...rest\r\n}) {\r\n\tconst list = useRef()\r\n\tconst [dragging, setDragging] = useState()\r\n\tconst [willEndDragging, setWillEndDragging] = useState()\r\n\tconst touchId = useRef()\r\n\tconst dragMoveHandler = useRef()\r\n\tconst draggedItemPosition = useRef()\r\n\tconst itemShiftsY = useRef()\r\n\r\n\tconst itemsOrder = useRef()\r\n\tconst prevItems = useRef()\r\n\tif (items !== prevItems.current) {\r\n\t\tprevItems.current = items\r\n\t\t// Reset items order.\r\n\t\titemsOrder.current = items.map((item, i) => i)\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\t// Don't know why is this here.\r\n\t\tconst onTouchMove = () => {}\r\n\t\twindow.addEventListener('touchmove', onTouchMove)\r\n\t\treturn () => {\r\n\t\t\twindow.removeEventListener('touchmove', onTouchMove)\r\n\t\t}\r\n\t}, [])\r\n\r\n\tconst onDragStart = useCallback((node, y, touch) => {\r\n\t\tif (dragging) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\t// The list requires at least two items in order to be sortable.\r\n\t\tif (items.length === 1) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tconst item = getItem(list.current, node, dragHandleDataAttribute)\r\n\t\tif (!item) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tconst [itemNode, position] = item\r\n\t\tsetDragging({\r\n\t\t\ttouch,\r\n\t\t\tinitialPosition: position,\r\n\t\t\t// Using `.getBoundingClientRect()` instead of `.offsetHeight`/`.offsetTop`\r\n\t\t\t// because `.offsetXxx` values don't know how to work with fractional pixels.\r\n\t\t\t// Fractional pixels (for example, `0.5`) are used on \"retina\" screens.\r\n\t\t\titemHeights: Array.prototype.map.call(list.current.childNodes, node => node.getBoundingClientRect().height),\r\n\t\t\titemSpacing: list.current.childNodes[1].getBoundingClientRect().top - list.current.childNodes[0].getBoundingClientRect().bottom,\r\n\t\t\titemTopOffset: itemNode.getBoundingClientRect().top - list.current.childNodes[0].getBoundingClientRect().top,\r\n\t\t\tdragStartY: y\r\n\t\t})\r\n\t\tdraggedItemPosition.current = {\r\n\t\t\tprevious: position,\r\n\t\t\tnew: position,\r\n\t\t\tshiftY: 0\r\n\t\t}\r\n\t\titemShiftsY.current = items.map(_ => 0)\r\n\t}, [dragging])\r\n\r\n\tconst onMouseDown = useCallback((event) => {\r\n\t\t// Left mouse button only.\r\n\t\tif (event.button !== 0) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tonDragStart(event.target, event.pageY)\r\n\t}, [onDragStart])\r\n\r\n\tconst onTouchStart = useCallback((event) => {\r\n\t\t// Single touch only.\r\n\t\tif (event.touches.length > 1) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tconst touch = event.changedTouches[0]\r\n\t\tonDragStart(event.target, touch.pageY, touch.identifier)\r\n\t}, [onDragStart])\r\n\r\n\tconst onDragMove = useCallback((event) => {\r\n\t\tif (!dragging) {\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tlet y\r\n\t\tif (dragging.touch !== undefined) {\r\n\t\t\tfor (const touch of event.changedTouches) {\r\n\t\t\t\tif (touch.identifier === dragging.touch) {\r\n\t\t\t\t\ty = touch.pageY\r\n\t\t\t\t\tbreak\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\ty = event.pageY\r\n\t\t}\r\n\r\n\t\tif (y === undefined) {\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tevent.preventDefault()\r\n\r\n\t\tconst movedY = y - dragging.dragStartY\r\n\t\tconst draggedItemOffsetTop = dragging.itemTopOffset + movedY\r\n\r\n\t\tconst position = getDraggedItemPosition(\r\n\t\t\tdragging.itemHeights,\r\n\t\t\tdragging.itemSpacing,\r\n\t\t\tdraggedItemOffsetTop,\r\n\t\t\tdragging.initialPosition\r\n\t\t)\r\n\r\n\t\tconst draggedItemHeight = dragging.itemHeights[dragging.initialPosition]\r\n\r\n\t\t// Update list items' positions.\r\n\t\titemShiftsY.current = items.map((_, j) => {\r\n\t\t\tif (j < dragging.initialPosition) {\r\n\t\t\t\tif (j >= position) {\r\n\t\t\t\t\treturn draggedItemHeight + dragging.itemSpacing\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn 0\r\n\t\t\t\t}\r\n\t\t\t} else if (j > dragging.initialPosition) {\r\n\t\t\t\tif (j <= position) {\r\n\t\t\t\t\treturn -1 * (draggedItemHeight + dragging.itemSpacing)\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn 0\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn movedY\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\t// Apply item shifts Y.\r\n\t\tlet i = 0\r\n\t\twhile (i < items.length) {\r\n\t\t\tlist.current.childNodes[i].style.transform = `translateY(${itemShiftsY.current[i]}px)`\r\n\t\t\ti++\r\n\t\t}\r\n\r\n\t\tdraggedItemPosition.current = {\r\n\t\t\tprevious: dragging.initialPosition,\r\n\t\t\tnew: position,\r\n\t\t\tshiftY: getDraggedItemPositionY(\r\n\t\t\t\tdragging.itemHeights,\r\n\t\t\t\tdragging.itemSpacing,\r\n\t\t\t\tdragging.initialPosition,\r\n\t\t\t\tposition\r\n\t\t\t) - getDraggedItemPositionY(\r\n\t\t\t\tdragging.itemHeights,\r\n\t\t\t\tdragging.itemSpacing,\r\n\t\t\t\tdragging.initialPosition,\r\n\t\t\t\tdragging.initialPosition\r\n\t\t\t)\r\n\t\t}\r\n\t}, [dragging])\r\n\r\n\tconst onDragEnd = useCallback(() => {\r\n\t\tsetDragging()\r\n\t\tsetWillEndDragging(true)\r\n\t\tconst newItemsOrder = getNewItemsOrder(\r\n\t\t\titemsOrder.current,\r\n\t\t\tdraggedItemPosition.current.previous,\r\n\t\t\tdraggedItemPosition.current.new\r\n\t\t)\r\n\t\tsetTimeout(() => {\r\n\t\t\tsetWillEndDragging(false)\r\n\t\t\titemsOrder.current = newItemsOrder\r\n\t\t\tonChange(newItemsOrder.map(i => items[i]))\r\n\t\t}, animationDuration)\r\n\t}, [itemsOrder.current])\r\n\r\n\tconst onMouseUp = useCallback((event) => {\r\n\t\tif (event.which !== 1) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tonDragEnd()\r\n\t}, [onDragEnd])\r\n\r\n\tconst onTouchEnd = useCallback((event) => {\r\n\t\tfor (const touch of event.changedTouches) {\r\n\t\t\tif (touch.identifier === touchId.current) {\r\n\t\t\t\tonDragEnd()\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t}\r\n\t}, [onDragEnd])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (dragging) {\r\n\t\t\tdragMoveHandler.current = onDragMove\r\n\t\t\tif (dragging.touch !== undefined) {\r\n\t\t\t\ttouchId.current = dragging.touch\r\n\t\t\t\twindow.addEventListener('touchmove', dragMoveHandler.current, { passive: false })\r\n\t\t\t\twindow.addEventListener('touchend', onTouchEnd)\r\n\t\t\t} else {\r\n\t\t\t\twindow.addEventListener('mousemove', dragMoveHandler.current, { passive: false })\r\n\t\t\t\twindow.addEventListener('mouseup', onMouseUp)\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (touchId.current !== undefined) {\r\n\t\t\t\ttouchId.current = undefined\r\n\t\t\t\twindow.removeEventListener('touchmove', dragMoveHandler.current, { passive: false })\r\n\t\t\t\twindow.removeEventListener('touchend', onTouchEnd)\r\n\t\t\t} else {\r\n\t\t\t\twindow.removeEventListener('mousemove', dragMoveHandler.current, { passive: false })\r\n\t\t\t\twindow.removeEventListener('mouseup', onMouseUp)\r\n\t\t\t}\r\n\t\t\tdragMoveHandler.current = undefined\r\n\t\t}\r\n\t}, [dragging])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (willEndDragging) {\r\n\t\t\t// Reset dragged item position.\r\n\t\t\tlist.current.childNodes[draggedItemPosition.current.previous].style.transform = `translateY(${\r\n\t\t\t\tdraggedItemPosition.current.shiftY\r\n\t\t\t}px)`\r\n\t\t}\r\n\t}, [willEndDragging])\r\n\r\n\treturn (\r\n\t\t<Component\r\n\t\t\t{...rest}\r\n\t\t\tref={list}\r\n\t\t\tonTouchStart={onTouchStart}\r\n\t\t\tonMouseDown={onMouseDown}>\r\n\t\t\t{itemsOrder.current.map((i, position) => (\r\n\t\t\t\t<ItemComponent\r\n\t\t\t\t\t{...itemComponentProps}\r\n\t\t\t\t\tkey={i}\r\n\t\t\t\t\tdragging={dragging ? true : false}\r\n\t\t\t\t\tdragged={dragging && position === draggedItemPosition.current.previous}\r\n\t\t\t\t\tstyle={(dragging || willEndDragging) ? getItemStyle(\r\n\t\t\t\t\t\tposition === draggedItemPosition.current.previous,\r\n\t\t\t\t\t\twillEndDragging,\r\n\t\t\t\t\t\titemShiftsY.current[position],\r\n\t\t\t\t\t\tanimationDuration,\r\n\t\t\t\t\t\tanimationEasing\r\n\t\t\t\t\t) : TRANSFORM_NONE}>\r\n\t\t\t\t\t{items[i]}\r\n\t\t\t\t</ItemComponent>\r\n\t\t\t))}\r\n\t\t</Component>\r\n\t)\r\n}\r\n\r\nSortableList.propTypes = {\r\n\tvalue: PropTypes.arrayOf(PropTypes.any).isRequired,\r\n\tonChange: PropTypes.func.isRequired,\r\n\tcomponent: PropTypes.elementType.isRequired,\r\n\titemComponent: PropTypes.elementType.isRequired,\r\n\titemComponentProps: PropTypes.object,\r\n\tanimationDuration: PropTypes.number.isRequired,\r\n\tanimationEasing: PropTypes.string.isRequired\r\n}\r\n\r\nconst TRANSFORM_NONE = { transform: 'none' }\r\n\r\nfunction getItemStyle(isDragged, willEndDragging, shiftY, animationDuration, animationEasing) {\r\n\tconst style = {\r\n\t\t// `position: relative` is for `z-index` to work.\r\n\t\tposition: 'relative',\r\n\t\ttransition: `all ${animationDuration}ms ${animationEasing}`\r\n\t}\r\n\tif (isDragged) {\r\n\t\tstyle.zIndex = 1\r\n\t\tif (!willEndDragging) {\r\n\t\t\tstyle.transition = undefined\r\n\t\t}\r\n\t} else {\r\n\t\tstyle.transform = `translateY(${shiftY}px)`\r\n\t}\r\n\treturn style\r\n}\r\n\r\nconst ListComponent = React.forwardRef(({ children, ...rest }, ref) => (\r\n\t<div ref={ref} {...rest}>\r\n\t\t{children}\r\n\t</div>\r\n))\r\n\r\nSortableList.defaultProps = {\r\n\tcomponent: ListComponent,\r\n\tanimationDuration: 200,\r\n\tanimationEasing: 'ease-out'\r\n}\r\n\r\n// Interactive elements aren't draggable.\r\nconst IGNORE_CLICKS_INSIDE_TAGS = [\r\n\t'a',\r\n\t'button',\r\n\t'input',\r\n\t'textarea',\r\n\t'select'\r\n]\r\n\r\n/**\r\n * Returns the list item that has been clicked (along with its index).\r\n * @param {Element} list\r\n * @param {Element} node — The DOM Element that has been clicked.\r\n * @param {string} [dragHandleDataAttribute] — Drag handle data attribute.\r\n * @return {any[]} [result] — An array having shape `[item, i]`.\r\n */\r\nfunction getItem(list, node, dragHandleDataAttribute) {\r\n\tlet handle\r\n\tlet childNode\r\n\twhile (node) {\r\n\t\tif (node === list) {\r\n\t\t\t// Clicked outside of a handle.\r\n\t\t\tif (dragHandleDataAttribute && !handle) {\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tif (childNode) {\r\n\t\t\t\tlet i = 0\r\n\t\t\t\twhile (i < node.childNodes.length) {\r\n\t\t\t\t\tif (node.childNodes[i] === childNode) {\r\n\t\t\t\t\t\treturn [childNode, i]\r\n\t\t\t\t\t}\r\n\t\t\t\t\ti++\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tbreak\r\n\t\t}\r\n\t\tif (IGNORE_CLICKS_INSIDE_TAGS.indexOf(node.tagName.toLowerCase()) >= 0) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif (node.dataset[dragHandleDataAttribute]) {\r\n\t\t\thandle = node\r\n\t\t}\r\n\t\tchildNode = node\r\n\t\tnode = node.parentElement\r\n\t}\r\n}\r\n\r\nfunction getDraggedItemPosition(itemHeights, itemSpacing, draggedItemOffsetTop, initialPosition) {\r\n\tconst scanLineY = draggedItemOffsetTop + itemHeights[initialPosition] / 2 + itemSpacing / 2\r\n\tlet y = 0\r\n\tlet i = 0\r\n\tlet subtractOwnPosition = 0\r\n\twhile (i < itemHeights.length) {\r\n\t\ty += itemHeights[i] + itemSpacing\r\n\t\tif (scanLineY <= y) {\r\n\t\t\treturn i\r\n\t\t}\r\n\t\ti++\r\n\t}\r\n\treturn itemHeights.length - 1\r\n}\r\n\r\nfunction getDraggedItemPositionY(itemHeights, itemSpacing, initialPosition, position) {\r\n\tlet top = 0\r\n\tlet j = 0\r\n\twhile (j < position) {\r\n\t\tif (j === initialPosition) {\r\n\t\t\tposition++\r\n\t\t} else {\r\n\t\t\ttop += itemHeights[j] + itemSpacing\r\n\t\t}\r\n\t\tj++\r\n\t}\r\n\treturn top\r\n}\r\n\r\nfunction getNewItemsOrder(itemsOrder, fromPosition, toPosition) {\r\n\tif (toPosition < fromPosition) {\r\n\t\treturn itemsOrder.slice(0, toPosition)\r\n\t\t\t.concat(itemsOrder[fromPosition])\r\n\t\t\t.concat(itemsOrder.slice(toPosition, fromPosition))\r\n\t\t\t.concat(itemsOrder.slice(fromPosition + 1))\r\n\t}\r\n\tif (toPosition > fromPosition) {\r\n\t\treturn itemsOrder.slice(0, fromPosition)\r\n\t\t\t.concat(itemsOrder.slice(fromPosition + 1, toPosition + 1))\r\n\t\t\t.concat(itemsOrder[fromPosition])\r\n\t\t\t.concat(itemsOrder.slice(toPosition + 1))\r\n\t}\r\n\treturn itemsOrder.slice()\r\n}"],"file":"SortableList.js"}